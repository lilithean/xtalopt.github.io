<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Github Page for XtalOpt, an evolutionary algortihm designed to predict crystal structures.">
  <meta name="author" content="Zackary Falls">
  <link rel="icon" href="dist/img/xtalopt-logo.png">
  <title>
      XtalOpt - Tutorials
  </title>

  <!-- Scripts -->
  <script src="dist/js/jquery.js"></script>
  <script type="text/javascript" src='dist/js/bootstrap.min.js'></script>
    <script>
      $(function(){
        $("#navbar").load("navbar.html");
      });
    </script>
    <script>
      $(function() {
        var pgurl = window.location.href.substr(window.location.href.lastIndexOf("/")+1);
        $(".navbar .nav a").each(function(){
          if($(this).attr("href") == pgurl || $(this).attr("href") == '' )
            $(this).addClass("active");
        })
      });
    </script>

  <!-- Styles -->
  <link href="dist/css/bootstrap.css" rel="stylesheet">
  <link href="dist/css/bootstrap-responsive.css" rel="stylesheet">
  <link href="dist/css/style.css" rel="stylesheet">

  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="dist/img/xtalopt-logo.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="dist/img/xtalopt-logo.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="dist/img/xtalopt-logo.png">
  <link rel="apple-touch-icon-precomposed" href="dist/img/xtalopt-logo.png">
  <link rel="shortcut icon" href="dist/img/xtalopt-logo.png">
</head>

  <body>
    <!--NavBar-->
    <div id="navbar"></div>

    <div class="container">
      <div class="jumbotron">
        <h1>XtalOpt Tutorial</h1>
      </div>

      <br>

      <div class="jumbotron">
        <h2 align="left">Contents</h2>
        <hr>
        <ul align="left" style="text-align:-moz-left">
            <li><a class="el" href="tut.html#launch">Launch XtalOpt</a></li>
            <li><a class="el" href="tut.html#init">Enter composition and restraints</a></li>
            <li><a class="el" href="tut.html#opt">Optimizer setup</a><ul>
                <li><a class="el" href="tut.html#vasp-opt">VASP</a></li>
                <li><a class="el" href="tut.html#gulp-opt">GULP</a></li>
                <li><a class="el" href="tut.html#pwscf-opt">PWscf</a></li>
                <li><a class="el" href="tut.html#castep-opt">CASTEP</a></li>
                <li><a class="el" href="tut.html#siesta-opt">SIESTA</a></li>
            </ul>
            </li>
            <li><a class="el" href="tut.html#qisetup">Queue setup</a><ul>
                <li><a class="el" href="tut.html#remotepbs">Using a remote PBS cluster</a></li>
                <li><a class="el" href="tut.html#remotesge">Using a remote SGE cluster</a></li>
                <li><a class="el" href="tut.html#remoteslurm">Using a remote SLURM cluster</a></li>
                <li><a class="el" href="tut.html#remotelsf">Using a remote LSF cluster</a></li>
                <li><a class="el" href="tut.html#remotell">Using a remote LoadLeveler cluster</a></li>
                <li><a class="el" href="tut.html#localqi">Running optimizations locally</a></li>
            </ul>
            </li>
            <li><a class="el" href="tut.html#files">What is written to the local directory?</a></li>
            <li><a class="el" href="tut.html#search-set">Search Settings</a></li>
            <li><a class="el" href="tut.html#begin">"Begin"</a></li>
            <li><a class="el" href="tut.html#prog-mon">Monitor progress</a><ul>
                <li><a class="el" href="tut.html#trends">View trends</a></li>
            </ul>
            </li>
            <li><a class="el" href="tut.html#xo_tut_further">Further reading</a><ul>
                <li><a class="el" href="optschemes.html">Optimization Schemes</a></li>
                <li><a class="el" href="xo__saveresume.html">Saving and Resuming Sessions in XtalOpt</a></li>
            </ul>
            <li><a class="el" href="tut.html#sr">Saving and Resuming Sessions in XtalOpt</a><ul>
                <li><a class="el" href="tut.html#sr_saving">How to save your session</a></li>
                <li><a class="el" href="tut.html#sr_resuming">How to resume your session</a></li>
            </ul>
            </li>
        </ul>
      </div>

      <a class="anchor" id="launch">
        <br>
      </a>

      <br>

      <div class="jumbotron">
        <h2>Launch XtalOpt</h2>
        <p>Open avogadro, go to the "Extensions" menu and select "XtalOpt".</p>
      </div>

      <a class="anchor" id="init">
        <br>
      </a>

      <div class="jumbotron">
        <h2>Enter composition and restraints</h2>
        <div align="center">
            <img src="dist/img/struct-lim.png" alt="struct-lim.png" width="80%">
        </div>
        <br>
         <p>The interface opens to the "Structure Limits" tab, shown above. We will use a 6 formula unit supercell of titanium dioxide for this tutorial, so enter "Ti6 O12" for the cell composition. We will assume that we know nothing about the system and use very loose restraints. Set all cell length minima to 1 angstrom and maxima to 20 angstrom. Constrain the angles to be between 60 and 120 degrees, and the volume from between 1 and 500 cubic angstrom. Specify a minimum interatomic distance of 0.5 angstrom. (Note that due to the angle adjustment described in the CPC 2010 publication, 60-120 degrees is the largest range of cell angles that XtalOpt will generate.)</p>
      </div>

      <a class="anchor" id="opt">
        <br>
      </a>

      <div class="jumbotron">
         <h2>Optimizer setup</a></h2>
         <p>XtalOpt currently supports the <a class="el" href="tut.html#vasp-opt">VASP</a>, <a class="el" href="tut.html#gulp-opt">GULP</a>, <a class="el" href="tut.html#pwscf-opt">PWscf</a>, <a class="el" href="tut.html#castep-opt">CASTEP</a>, and <a class="el" href="tut.html#siesta-opt">SIESTA</a> codes for performing geometry optimizations. Each is detailed in its own section below.</p>



<!-- VASP -->
    <a class="anchor" id="vasp-opt">
        <br><br>
    </a>

    <h3>VASP</h3>
        <img src="dist/img/opt-set-vasp.png" alt="opt-set-vasp.png" width="80%">
        <br>
        <br>
        <p>
        On the next tab, load the optimization scheme by clicking the "Load
Opt Scheme" button and selecting the "samples/vasp-xtalopt.scheme" file that is distributed with the source code. If you do not have a copy of the source code, the scheme file can be obtained by clicking the "Original Format" link at the bottom of the page <a href="samples/vasp-xtalopt.scheme">here</a>.</p>
<p>For more details on optimization schemes, see optschemes.</p>
<p>After loading the optimization scheme, XtalOpt will prompt for the POTCAR files to use. Select files appropriated for the prompted atom. XtalOpt will construct the POTCAR files on the local computer, and then copy them over to the cluster when the calculation is submitted. It is necessary to have the VASP POTCAR files for each atomic species located somewhere on the local computer. See the VASP manual for information on obtaining the POTCAR files.</p>
<p>Take a moment to look through each file for each optimization step. Notice that the INCAR template includes two user-specified values, %user2% and %user3% for the external pressure and the energy cutoff, respectively. By entering appropriate values in the "user2:" and "user3:" fields on the left, it is easy to update these values for all optimization steps.</p>
<p>Notice the other %keyword% values in the job.pbs templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>
<p>XtalOpt expects VASP to use the default filenames, mainly POSCAR, CONTCAR, and OUTCAR.</p>
<p><a class="el" href="tut.html#qisetup">Skip to next section.</a></p>



<!-- GULP -->
    <a class="anchor" id="gulp-opt">
        <br><br>
    </a>

<h3>GULP</h3>
<img src="dist/img/opt-set-gulp.png" alt="opt-set-gulp.png" width="80%">
        <br>
        <br>
 <p>On the next tab we choose GULP for the local optimizer and enter a template for GULP to use. Select "GULP" as the "Optimizer" and "xtal.gin" as "Template". Next, fill out the text field on the right with the following template: </p>

 <pre align="left" style="text-align:-moz-left">opti conj conp
switch_minimiser bfgs gnorm 0.5

cell
  %a% %b% %c% %alphaDeg% %betaDeg% %gammaDeg%

frac
  %coordsFrac%

species
  Ti 2.196
  O -1.098

buck
  Ti Ti 31120.1 0.1540 5.25  15
  O  O  11782.7 0.2340 30.22 15
  Ti O  16957.5 0.1940 12.59 15

lennard 12 6
  Ti Ti 1 0 15
  O  O  1 0 15
  Ti O  1 0 15</pre>
 <br>

 <p>
 Alternatively, one can load the scheme file distributed with the source code under samples/gulp-TiO-xtalopt.scheme. If the source code is not available, the scheme file can be obtained by clicking the "Original Format" link at the bottom of the page <a href="http://xtalopt.openmolecules.net/wiki/index.fcgi/browser/samples/gulp-TiO-xtalopt.scheme">here</a>.
 </p>
 <p>
 For more details on optimization schemes, see optschemes.
 </p>
<p>
Note the "%" surrounding various keywords. These will be replaced by the structure-specific data when the optimizer is invoked for each structure. Click "Help" to view all of the keywords available. The number of optimization steps can be modified with the "Add/Resume" buttons. The "user" fields in the lower left corner allow users to specify their own keyword/value pairs, which is useful for making changes to multiple optimization steps at once. We will only be using one optimization step in this tutorial.
</p>
<p>
XtalOpt expects GULP to use the following filenames:
</p>
<div align="center">
    <pre>gulp &lt; xtal.gin &gt; xtal.got</pre>
</div>
<br>

<p>
  <a class="el" href="tut.html#qisetup">Skip to next section.</a>
</p>

    <a class="anchor" id="pwscf-opt">
        <br><br>
    </a>

<h3>PWscf</h3>
<img src="dist/img/opt-set-pwscf.png" alt="opt-set-pwscf.png" width="80%">
        <br>
        <br>
 <p>On the next tab, load the optimization scheme that is distributed with the source code under the samples/ directory. The scheme that we want is named "pwscf-xtalopt.scheme". If the source code is not available, the scheme file can be obtained by clicking the "Original Format" link at the bottom of the page <a href="http://xtalopt.openmolecules.net/wiki/index.fcgi/browser/samples/pwscf-xtalopt.scheme">here</a>.</p>
<p>For more details on optimization schemes, see optschemes.</p>
<p>Each PWscf input file will need to be edited to specify:</p>
<ol type="1" align=left style="text-align:-moz-left">
  <li>The pseudo_dir containing the pseudopotential files on the remote cluster, and</li>
  <li>The pseudopotentials for each atom (under ATOMIC_SPECIES)</li>
</ol>
<br>
<p>Take a moment to look through each file for each optimization step.</p>
<p>Notice the %keyword% values in the job.pbs templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>
<p>Be aware that every PWscf/CASTEP installation is different, and it is almost certain that the job.pbs file included with this scheme will not work on any cluster other than the Zurek group's "parity" cluster at SUNY Buffalo's Center for Computational Resources. It may take some experimentation to get jobs to submit successfully, and you may need to contact the mantainers of the cluster for assistance for information about MPI, executable locations, etc. Perhaps the easiest method to find the correct PBS script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>XtalOpt expects PWscf to use the following filenames:</p>

<div class="fragment"><div class="line"><pre>pw.x &lt; xtal.in &gt; xtal.out</pre></div>
</div><!-- fragment --><p>

<br>
<a class="el" href="tut.html#qisetup">Skip to next section.</a></p>

    <a class="anchor" id="castep-opt">
        <br><br>
    </a>

<h3>CASTEP</h3>
<img src="dist/img/opt-set-castep.png" alt="opt-set-castep.png" width="80%">
        <br>
        <br>
 <p>On the next tab, load the optimization scheme that is distributed with the source code under the samples/ directory. The scheme that we want is named "castep-xtalopt.scheme". If the source code is not available, the scheme file can be obtained by clicking the "Original Format" link at the bottom of the page <a href="http://xtalopt.openmolecules.net/wiki/index.fcgi/browser/samples/castep-xtalopt.scheme">here</a>.</p>
<p>For more details on optimization schemes, see optschemes.</p>
<p>It is important to note that CASTEP input files require the "%" character to define blocks. The percent character is special in the XtalOpt input template parser to define keywords (see below). To insert a literal "%" into the input, use percent%.</p>
<p>E.g. Specification of the fractional coordinate block in the .cell template should look like:</p>


<div class="fragment"><div class="line">%percent%BLOCK POSITIONS_FRAC</div>
<div class="line">%coordsFrac%</div>
<div class="line">%percent%ENDBLOCK POSITIONS_FRAC</div>
</div><!-- fragment --><p>Take a moment to look through each file for each optimization step.</p>


<p>Notice the %keyword% values in the job.pbs templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>
<p>Be aware that every PWscf/CASTEP installation is different, and it is almost certain that the job.pbs file included with this scheme will not work on any cluster other than the Zurek group's "parity" cluster at SUNY Buffalo's Center for Computational Resources. It may take some experimentation to get jobs to submit successfully, and you may need to contact the mantainers of the cluster for assistance for information about MPI, executable locations, etc. Perhaps the easiest method to find the correct PBS script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>XtalOpt expects CASTEP to use the following filenames:</p>


<div class="fragment"><div class="line"><span class="preprocessor"># XtalOpt will write xtal.cell, xtal.param</span></div>
<div class="line">castep xtal</div>
<div class="line"><span class="preprocessor"># CASTEP will create xtal.castep</span></div>
</div><!-- fragment -->
<br>

<p>
  <a class="el" href="tut.html#qisetup">Skip to next section.</a>
</p>


    <a class="anchor" id="siesta-opt">
        <br><br>
    </a>

    <h3>SIESTA</h3>

    <p>On the next tab we choose GULP for the local optimizer and enter a template for SIESTA to use. Select "SIESTA" as the "Optimizer" and "xtal.fdf" as "Template".</p>

    <p>Next, fill out the text field on the right with the following template:</p>

 <pre align="left" style="text-align:-moz-left">SystemName %description%
SystemLabel %description%-%gen%x%id%

NumberOfAtoms %numAtoms%
NumberOfSpecies %numSpecies%

%block Chemical_Species_Label
%chemicalSpeciesLabel%
%endblock Chemical_Species_Label

PAO.BasisSize SZ

# Lattice, coordinates, k-sampling
AtomicCoordinatesFormat Fractional
AtomicCoorFormatOut Ang

%block% AtomicCoordinatesAndAtomicSpecies
%atomicCoordsAndAtomicSpecies%
%endblock% AtomicCoordinatesAndAtomicSpecies

LatticeConstant 4.10 Ang
%block% LatticeVectors
%cellMatrixAngstrom%
%endblock% LatticeVectors

kgrid_cutoff 7. Ang

# DFT, Grid, SCF
XC.functional LDA # Exchange-correlation functional type
XC.authors CA # Particular parametrization of xc func
SpinPolarized .false. # Spin unpolarized calculation
MeshCutoff 200. Ry # Equivalent planewave cutoff for the grid
MaxSCFIterations 100 # Maximum number of SCF iterations per step
DM.MixingWeight 0.3 # New DM amount for next SCF cycle
DM.Tolerance 1.d-4 # Tolerance in maximum difference

# between input and output DM
DM.NumberPulay 3 # Number of SCF steps between pulay mixing

# Eigenvalue problem: order-N or diagonalization
SolutionMethod diagon # OrderN or Diagon
ElectronicTemperature 5 K # Temp. for Fermi smearing

# Molecular dynamics and relaxations
MD.TypeOfRun cg # Type of dynamics:</pre>

 <p>Or load the optimization scheme by clicking the "Load Opt Scheme" button and selecting the "samples/siesta-xtalopt.scheme" file that is distributed with the source code.</p>

 <p>For more details on optimization schemes, see optschemes.</p>

 <p>After loading the optimization scheme, XtalOpt will prompt for the xtal.psf files to use. Select files appropriated for the prompted atom. XtalOpt will copy the individual files over to each structure directory when the calculation is submitted. See the SIESTA manual for information on obtaining the .psf files.</p>

 <p>Notice the other %keyword% values in the xtal.fdf templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>

 <p>XtalOpt expects SIESTA to use the following filenames:</p>

 <pre>siesta < xtal.fdf > xtal.out</pre>

 </div>


    <a class="anchor" id="qisetup">
      <br>
    </a>

      <div class="jumbotron">
<h2>Queue setup</h2>
<p>XtalOpt currently supports using the <a class="el" href="tut.html#remotepbs">PBS</a>, <a class="el" href="tut.html#remotesge">SGE</a>, <a class="el" href="tut.html#remoteslurm">SLURM</a>, <a class="el" href="tut.html#remotelsf">LSF</a>, and <a class="el" href="tut.html#remotell">LoadLeveler</a> queuing systems on remote SSH-accessible clusters, as well as an internal <a class="el" href="tut.html#localqi">local</a> queue that manages calculations on the user's workstation. Each queueing interface is detailed in its own section below.</p>



<!-- Remote - SGE -->
    <a class="anchor" id="remotepbs">
        <br><br>
    </a>

<h3>Using a remote PBS cluster</h3>
<img src="dist/img/opt-set-pbs.png" alt="opt-set-pbs.png" width="50%">
    <br>
    <br>
 <p>Select "PBS" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align="left" style="text-align:-moz-left">
<li>host: The hostname of the PBS cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to qsub: Where to find the qsub executable on the remote cluster. Note that if qsub is in the cluster's $PATH, setting this to just 'qsub' will work.</li>
<li>Path to qdel: Where to find the qdel executable on the remote cluster. Note that if qdel is in the cluster's $PATH, setting this to just 'qdel' will work.</li>
<li>Path to qstat: Where to find the qstat executable on the remote cluster. Note that if qstat is in the cluster's $PATH, setting this to just 'qstat' will work.</li>
</ul>
<p>A new template, "job.pbs" is added to the list of available templates. This is the job submission script for PBS. This script should roughly follow this design:</p>

<div class="fragment"><div class="line"><span class="preprocessor">#/bin/bash</span></div>
<div class="line"><span class="preprocessor">#PBS -l nodes=1:ppn=8</span></div>
<div class="line"><span class="preprocessor">#PBS -o ../%gen%x%id%-%optstep%.out</span></div>
<div class="line"><span class="preprocessor">#PBS -e ../%gen%x%id%-%optstep%.err</span></div>
<div class="line"><span class="preprocessor">#PBS -N %description%-%gen%x%id%-%optstep%</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">###Include this for XtalOpt scripts!###</span></div>
<div class="line">export PBS_O_WORKDIR=%rempath%</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Change to structure&#39;s working directory, copy input files to node&#39;s scratch dirs:</span></div>
<div class="line"><span class="keywordflow">for</span> node in `cat $PBS_NODEFILE | sort | uniq`; <span class="keywordflow">do</span></div>
<div class="line">rsh $node <span class="stringliteral">&quot;cp $PBS_O_WORKDIR/* $PBSTMPDIR/;&quot;</span>;</div>
<div class="line">done</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Move to the scratch directory</span></div>
<div class="line">cd $PBSTMPDIR</div>
<div class="line">echo <span class="stringliteral">&quot;running in directory $PBSTMPDIR&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Set any environment variables needed for the optimizer/MPI here:</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Run optimizer, be sure to use the filenames that XtalOpt expects.</span></div>
<div class="line"><span class="preprocessor"># See the template menu in XtalOpt and the example templates in the</span></div>
<div class="line"><span class="preprocessor"># samples/ directory of the XtalOpt sources.</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Don&#39;t forget to clean up after MPI if needed!</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Print files from each node</span></div>
<div class="line"><span class="keywordflow">for</span> node in `cat $PBS_NODEFILE | sort | uniq`; <span class="keywordflow">do</span></div>
<div class="line">echo <span class="stringliteral">&quot;$node:&quot;</span></div>
<div class="line">rsh $node <span class="stringliteral">&quot;ls -l $PBSTMPDIR&quot;</span></div>
<div class="line">done</div>
<div class="line"><span class="preprocessor"># Copy back results from master node&#39;s scratch directory</span></div>
<div class="line"><span class="preprocessor">cp $PBSTMPDIR</span><span class="comment">/* $PBS_O_WORKDIR/</span></div>
</div><!-- fragment -->


<p>For more details on optimization schemes, see optschemes.</p>
<p>Be aware that every installation is different, and it is almost certain that the job.pbs file included with this scheme will not work on any cluster other than the Zurek group's "parity" cluster at SUNY Buffalo's Center for Computational Resources. It may take some experimentation to get jobs to submit successfully, and you may need to contact the mantainers of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct PBS script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>A handy trick for monitoring jobs outside of XtalOpt is to include the following line in job.pbs:</p>

<div class="fragment"><div class="line"><span class="preprocessor">#PBS -N %description%-%gen%x%id%-%optstep%</span></div>
</div><!-- fragment -->

<p>This will name each job, for example, xtalSearch-3x4-2, where xtalSearch is a user-specified description of the search, and 3x4-2 means that it is the fourth structure in the third generation running its second optimization step.</p>
<br>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - SGE -->
    <a class="anchor" id="remotesge">
        <br><br>
    </a>

<h3>Using a remote SGE cluster</h3>
<img src="dist/img/opt-set-sge.png" alt="opt-set-sge.png" width="50%"/>
<br>
<br>
<p>Select "SGE" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
<ul align=left style="text-align:-moz-left">
<li>host: The hostname of the SGE cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to qsub: Where to find the qsub executable on the remote cluster. Note that if qsub is in the cluster's $PATH, setting this to just 'qsub' will work.</li>
<li>Path to qdel: Where to find the qdel executable on the remote cluster. Note that if qdel is in the cluster's $PATH, setting this to just 'qdel' will work.</li>
<li>Path to qstat: Where to find the qstat executable on the remote cluster. Note that if qstat is in the cluster's $PATH, setting this to just 'qstat' will work.</li>
</ul>
<p>A new template, "job.sge" is added to the list of available templates. This is the job submission script for SGE. It may take some experimentation to get jobs to submit successfully, and you may need to contact the mantainers of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct SGE script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see optschemes.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - SLURM -->
    <a class="anchor" id="remoteslurm">
        <br><br>
    </a>

<h3>Using a remote SLURM cluster</h3>
<img src="dist/img/opt-set-slurm.png" alt="opt-set-slurm.png" width="50%"/>
<br>
<br>
<p>Select "SLURM" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>host: The hostname of the SGE cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to sbatch: Where to find the sbatch executable on the remote cluster. Note that if sbatch is in the cluster's $PATH, setting this to just 'sbatch' will work.</li>
<li>Path to scancel: Where to find the scancel executable on the remote cluster. Note that if scancel is in the cluster's $PATH, setting this to just 'scancel' will work.</li>
<li>Path to squeue: Where to find the squeue executable on the remote cluster. Note that if squeue is in the cluster's $PATH, setting this to just 'squeue' will work.</li>
</ul>
<p>A new template, "job.slurm" is added to the list of available templates. This is the job submission script for SLURM. It may take some experimentation to get jobs to submit successfully, and you may need to contact the mantainers of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct SLURM script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see optschemes.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - LSF -->
    <a class="anchor" id="remotelsf">
        <br><br>
    </a>

<h3>Using a remote LSF cluster</h3>
<img src="dist/img/opt-set-lsf.png" alt="opt-set-lsf.png" width="50%"/>
<br>
<br>
<p>Select "LSF" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>host: The hostname of the LSF cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to bsub: Where to find the bsub executable on the remote cluster. Note that if bsub is in the cluster's $PATH, setting this to just 'bsub' will work.</li>
<li>Path to bkill: Where to find the bkill executable on the remote cluster. Note that if bkill is in the cluster's $PATH, setting this to just 'bkill' will work.</li>
<li>Path to bjobs: Where to find the bjobs executable on the remote cluster. Note that if bjobs is in the cluster's $PATH, setting this to just 'bjobs' will work.</li>
</ul>
<p>A new template, "job.lsf" is added to the list of available templates. This is the job submission script for LSF. It may take some experimentation to get jobs to submit successfully, and you may need to contact the mantainers of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct LSF script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see optschemes.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - LoadLeveler -->
    <a class="anchor" id="remotell">
        <br><br>
    </a>

<h3>Using a remote LoadLeveler cluster</h3>
<img src="dist/img/opt-set-ll.png" alt="opt-set-ll.png" width="50%"/>
<br>
<br>
<p>Select "LoadLeveler" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>host: The hostname of the LoadLeveler cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to llsubmit: Where to find the llsubmit executable on the remote cluster. Note that if llsubmit is in the cluster's $PATH, setting this to just 'llsubmit' will work.</li>
<li>Path to llcancel: Where to find the llcancel executable on the remote cluster. Note that if llcancel is in the cluster's $PATH, setting this to just 'llcancel' will work.</li>
<li>Path to llq: Where to find the llq executable on the remote cluster. Note that if llq is in the cluster's $PATH, setting this to just 'llq' will work.</li>
</ul>
<p>A new template, "job.ll" is added to the list of available templates. This is the job submission script for LoadLeveler. It may take some experimentation to get jobs to submit successfully, and you may need to contact the mantainers of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct LoadLeveler script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see optschemes.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>





    <a class="anchor" id="localqi">
        <br><br>
    </a>

<h3>Running optimizations locally</h3>
<img src="dist/img/opt-set-local.png" alt="opt-set-local.png" width="25%">
<br>
<br>
 <p>Select "Local" from the list of Queues, and then click the configure button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>Local working directory: A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
</ul>
<p>If the optimizer's executable (vasp, gulp, pw.x, castep, etc) is not in your system path, you will need to specify the location of the executable by clicking the "Configure..." button next to the optimizer selection menu.</p>
<p>For more details on optimization schemes, see optschemes.</p>
</div>



    <a class="anchor" id="files">
        <br>
    </a>

      <div class="jumbotron">
<h2>What is written to the local directory?</h2>
<p>A directory for each structure is created at</p>
<div class="fragment"><div class="line">[Local working directory]/&lt;gen#&gt;x&lt;id#&gt;</div>
</div><!-- fragment --><p>that will contain input, output, and data files specific to each structure. Two additional files are also written to the local filesystem:</p>
<div class="fragment"><div class="line">[Local working directory]/xtalopt.state</div>
</div><!-- fragment --><p>which contains save/resume information to continue a session that has been stopped, and</p>
<div class="fragment"><div class="line">[Local working directory]/results.txt</div>
</div><!-- fragment --><p>which stores a list of all structures sorted by increasing enthalpy. The latter file is handy for offline analysis, since there is no need to open XtalOpt to find the most stable structures of a previous search.</p>
    </div>



    <a class="anchor" id="search-set">
        <br><br>
    </a>

    <div class="jumbotron">
<h2>Search Settings</h2>
<div class="image">
<img src="dist/img/search-set.png" alt="search-set.png"/>
</div>
 <p>In the "Search Settings" tab, most of the default settings should suffice (See CPC 2010 publication). We arbitrarily set the initial structures to 20 and the continuous structures to 5, although these may need to be adjusted based on available resources. We will not specify initial seeds, but the option to do so exists on this screen.</p>
<p>It is not neccessary to limit the number of running jobs unless running locally, as the PBS queue on the cluster will manage job control for us. If running locally, set the job limit no higher than [number of available processor cores] - 1 (e.g. for a quadcore processor, allow three jobs to run simultaneously). This allows one core to remain free for the system to run.</p>
    </div>



    <a class="anchor" id="begin">
        <br><br>
    </a>

    <div class="jumbotron">
<h2>"Begin"</h2>
<div class="image">
<img src="dist/img/prog-start.png" alt="prog-start.png"/>
<div class="caption">
The ``Progress'' tab immediately after starting a search</div></div>
<p>XtalOpt has everything it needs to start its search at this point; click the "Begin" button in the lower right corner of the application to tell it to start the search algorithm. A progress bar appears as the random first generation is created. Switch to the "Progress" tab and 20 entries will appear, all with a status of "Waiting for
Optimization". Click "Refresh" on this tab to begin the local optimizations. From here, XtalOpt will continue to run without user input, starting new optimizations and generating new structures until it is stopped by the user.</p>
    </div>

    <a class="anchor" id="prog-mon">
        <br><br>
    </a>

    <div class="jumbotron">
<h2>Monitor progress</h2>
<div class="image">
<img src="dist/img/prog-mon.png" alt="prog-mon.png"/>
<div class="caption">
The ``Progress'' tab mid-run</div></div>
<p>As XtalOpt performs the search, the progress table continuously updates, providing information about each structure. We see individuals in various stages of completion: most are optimized (in yellow), structure 2x7 has been automatically marked as a duplicate (dark green) of structure 3x3 and removed from the breeding pool, structure 4x4 is currently undergoing a local optimization (light green), while structure 4x5 is waiting to be optimized (blue).</p>
<p>Other useful information is displayed about each structure, such as the time spent in optimization, the optimized enthalpy, the cell volume, spacegroup, and each structure's ancestry (i.e. parent(s) and parameters for the genetic operator that generated it). A status bar on the bottom of the window shows the number of structures that are optimized, running, and failing at any given time. This information is visible regardless of which tab is currently being viewed.</p>
<p>An additional feature of the progress table is the ability to immediately visualize any of the individuals in the Avogadro main window &ndash; simply clicking on a row in this table will display the three-dimensional structure in Avogadro, where it can be visualized, modified, or exported. If the user would like to add a bit of "intelligent design" to the evolutionary process, a structure can be modified and then resubmitted using a context (right-click) menu from the progress table. The context menu provides tools to (un)kill a structure, resubmit for local optimization at an arbitrary optimization step, or replace a problematic structure with a new, random individual.</p>
<h3><a class="anchor" id="trends"></a>
View trends</h3>
<div class="image">
<img src="dist/img/trend-view.png" alt="trend-view.png"/>
<div class="caption">
The ``Plot'' tab mid-run displaying enthalpy vs. volume. Each structure is labeled with its Hermann Mauguin spacegroup symbol.</div></div>
<p>Another visualization and analysis tool available during the search is the interactive plot. The plot is capable of investigating trends in the search by plotting a point for each individual using structure number, generation number, enthalpy, energy, $PV$ enthalpy term, lattice parameters, or cell volume on either axis. This powerful feature allows the user to visualize complex relationships present in the generated structures. E.g., a plot of enthalpy vs. structure number provides an overview of the search's progress. Or, recalling that H = U + PV, plotting enthalpy vs. PV enthalpy term or energy lends insight into whether the enthalpy (H) is dominated by atomic interactions (U) or cell parameters (PV). Further information is available by labeling the points with the individual's spacegroup number, Hermann Mauguin spacegroup symbol, enthalpy, energy, PV term, volume, generation, or index number.</p>
<p>A particularly useful plot is that of enthalpy vs. cell volume, as shown above. From this view, we see a general trend that enthalpy increases with volume (the effect is much more pronounced for systems at higher pressures), and also that below a certain volume enthalpy rises sharply. From this data set, we see that there is a cluster of very low enthalpy structures with cell volumes around 180 cubic angstroms. Armed with this data, we can update the starting volume on the Structure Limits tab mid-run to reflect this new piece of information that the search has provided us. Many of the other parameters governing structure generation and algorithm specifics can be similarly modified during a search without the need to restart the algorithm.</p>
<p>The plot is also interactive; zooming and panning are possible using simple mouse controls. Clicking on a structure's point on the plot will load it in the main Avogadro window, allow all the same functionality as described above in <a class="el" href="tut.html#prog-mon">Monitor progress</a>.</p>
    </div>

    <a class="anchor" id="sr">
        <br><br>
    </a>

    <div class="jumbotron">
<h2>Saving and Resuming Sessions in XtalOpt</h2>
<img src="dist/img/xo-saveresume.png" alt="xo-saveresume.png"/>
 <h3><a class="anchor" id="sr_saving">
         How to save your session</a></h3>
 <p>XtalOpt will write a small file named xtalopt.state to its working directory that contains the information necessary to resume the session at a later time. The file can be rewritten manually by clicking the "Save Session" button highlighted above, and XtalOpt will automatically save the session every time a structure is updated.</p>
 <p>XtalOpt will also write a file "structure.state" in each candidate structure's directory. This file stores XtalOpt-specific information about the structure.</p>
 <h3><a class="anchor" id="sr_resuming">
         How to resume your session</a></h3>
 <p>To resume a session, simply click "Resume stored session" (highlighted above) and select the xtalopt.state file in the working directory of the session you would like to resume. XtalOpt will then begin to load the structures and search parameters. You can monitor the progress with the progress bar that appears at the bottom of the window.</p>
 <p>While the structures are loading, you may encounter errors that say:</p>
 <div class="fragment"><pre class="fragment">
Error, no (or not appropriate for [OPTIMIZER]) xtal data in [DIRECTORY].

This could be a result of resuming a structure that has not yet done
any local optimizations. If so, safely ignore this message.</pre>
</div><p>As mentioned in the message, these can typically be ignored if it only happens for a handful of structures. This occurs when a structure has been generated in XtalOpt, but it has not completed any geometry optimizations so there are no output files from which to load the geometry. If it happens for a significant number of structures (or structures that are known to have completed at least one geometry optimization step), the output files from the optimizer may be missing or corrupt.</p>
 <p>After resuming a session, XtalOpt will ask if you would like to continue the search or enter read-only mode. Read-only mode will not generate new structures or submit geometry optimizations.</p>
 <dl class="note"><dt><b>Note:</b></dt><dd>If you are considering resuming a read-only session, take a look at the results.txt file in the working directory. It contains a list of all structures, sorted by enthalpy, with additional useful information. This can save some time when trying to locate the most stable structure of an old search.</dd></dl>
 <p>The working directories for XtalOpt are relocatable, meaning that the directory containing xtalopt.state and the [gen]x[id] structure folders may be moved, tarred, zipped, etc. and still be resumed at a later time from a different location on the filesystem, or even a different computer. </p>
</div>

<!-- start footer part -->
<br>
<p align="right" style="font-size:10pt;text-align:right">
Generated on Sun Apr 26 2015 01:32:48 for My Project by<a href="http://www.doxygen.org/index.html">
<img  src="dist/img/doxygen.png" alt="doxygen" align="absmiddle" style="width:10vw">
</a> 1.8.9.1
</p>

</div>

</body>
</html>
